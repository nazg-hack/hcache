sudo: required
language: generic
services:
 - docker
env:
  global:
  - DOCKER_COMPOSE_VERSION=1.23.2
  matrix:
  - HHVM_VERSION=4.0.0
  - HHVM_VERSION=4.0.1 
  - HHVM_VERSION=4.0.2
  - HHVM_VERSION=4.0.3
  - HHVM_VERSION=4.1.0
  - HHVM_VERSION=latest

before_install:
 - sudo rm /usr/local/bin/docker-compose
 - curl -L https://github.com/docker/compose/releases/download/${DOCKER_COMPOSE_VERSION}/docker-compose-`uname -s`-`uname -m` > docker-compose
 - chmod +x docker-compose
 - sudo mv docker-compose /usr/local/bin
 - docker-compose build
 - docker-compose up -d
script:
 - docker-compose exec hhvm /bin/bash -c 'cd /var/source && composer update'
 - docker-compose exec hhvm /bin/bash -c 'cd /var/source && hh_client && hhvm ./vendor/bin/hacktest.hack tests/'
matrix:
  fast_finish: true
